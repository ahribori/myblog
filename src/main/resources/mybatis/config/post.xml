<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="post">
	<resultMap type="post" id="postRM">
		<result property="postId" column="post_id"/>
		<result property="categoryId" column="category_id"/>
		<result property="title" column="title"/>
		<result property="subtitle" column="subtitle"/>
		<result property="writer" column="writer"/>
		<result property="content" column="content"/>
		<result property="hits" column="hits"/>
		<result property="regDate" column="reg_date"/>
		<result property="modDate" column="mod_date"/>
	</resultMap>
	
	<insert id="insertPost">
		<selectKey keyProperty="postId" resultType="int" order="AFTER">
			select max(post_id) from post
		</selectKey>
		insert into post(title,subtitle,writer,content) 
		values(#{title},#{subtitle},#{writer},#{content})
	</insert>
	
	<select id="post.getPost" resultMap="postRM">
		select * from post where post_id=#{postId}
	</select>
	
	<update id="updatePost">
		update post set title=#{title},subtitle=#{subtitle},content=#{content},hits=#{hits} 
		where post_id=#{postId}
	</update>
	
	<delete id="deletePost">
		delete from post where post_id=#{postId}
	</delete>
	
	<delete id="deleteAll">
		truncate post
	</delete>
	
	<select id="getTotalCount" resultType="int">
		select count(*) from post
	</select>
	
	<select id="getPosts" resultMap="postRM">
		select * from post order by post_id desc limit #{limit},#{pageSize} 
	</select>

	<select id="getPostsWithoutContent" resultMap="postRM">
		select post_id,category_id,title,subtitle,writer,hits,reg_date,mod_date 
		from post order by post_id desc limit #{limit},#{pageSize} 
	</select>
	
	<update id="upHits">
		update post set hits=#{hits} where post_id=#{postId}
	</update>
	
</mapper>
 
 